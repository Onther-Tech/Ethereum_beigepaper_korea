# Memory and Storage


## World State
 World state는 블록으로 나누어고, 각 새블록은 새로운 world state를 나타낸다. World state의 구조는 RLP 표준을 사용하는 주소와 계정 상태와 매핑된다. 이 정보는 데이터베이스의 뒷 단에 있는 머클 패트리샤 트리로 저장되며 그것은 바이트 배열과 바이트 배열을 매핑을 유지한다. 전체적으로 상태 데이터베이스에서 전체 데이터베이스 관계의 총합을 상태라고 한다.

### merkle patricia trees
 merkle patricia trees는 여기서 노드는 전체 해시를 나타내는 각 노드가 전체 해시를 나타내는 것이 아니라 해시로 부터 개별 문자를 표현하는 수정 된 merkle tree이다. 이를 통해 상태 데이터 구조 자체가 본질적으로 데이터의 올바른 경로뿐만 아니라 데이터 조각이 처음부터 유효했는지 확인하는 데 필요한 필수적인 암호학적 증명을 할 수 있다. 다시말하자면, 표준 머클트리의 구조와 표준 라딕스 트리의 구조를 조합해 블록체인의 유효성을 유지하는 것을 의미한다. 이더리움의 모든 검색 및 정렬 알고리즘은 이 엄격하고 정확한 데이터베이스를 통해 필터링 되므로 정보의 정확성이 보장된다. 다음 그림은 16진수 a와 4로 시작되는 트리를 탐색하는 과정이다.
 [그림 추가 예정]

## Tree Terminology
- Root node - 트리에서 첫 번째 노드
- Child Node -  루트에서부터 이동할 때 다른 노드에 직접 연결된 노드
- Parent Node - 자식의 반대 개념.
- Sibling Nodes - 같은 부모를 가진 노드들의 집합
- Descendant Node - 부모 노드에서 자식 노드로 반복적으로 진행하여 도달 할 수있는 노드
- Ancestor Node - 자식노드에서 부모노드로 반복적으로 진행하여 도달 할 수 있는 노드
- Leaf Node - 자식 노드가 없는 노드
- Branch Node - 최소 한개의 자식이 있는 노드
- Degree - 노드의 서브트리의 개수
- Edge - 한 노드와 다른 노드의 연결
- Path - 노드와 자손을 연결하는 엣지의 순서
- Level - 노드 레벨은 1 + (노드와 루트 간의 연결 수)로 정의됨
- Node Height - 노드와 리프 사이의 가장 긴 경로에있는 엣지의 수
- Tree Height - 루트 노드의 높이
- Depth - 트리의 루트 노드에서 노드까지의 엣지 수
- Forest - n>= 0 개의 분리 된 트리

### Recursive Length Prefix Encoding
 RLP (Recursive Length Prefix Encoding)는 접두사가있는 16 진수 값을 본질적으로 고려하여 데이터를 상태 데이터베이스 트리에 배치하는 구조를 데이터에 적용하는 것이다. 이 16진수 값은 특정 데이터 조각의 위치를 결정한다. rlp로 인코딩할 수 있는 기본적인 항목은 바이트 문자열과 다른 항목의 리스트(list of other items)이다.
 RLP는 중첩 된 바이너리 데이터의 배열을 임의의 깊이로 인코딩 하는데, 그것은 이더리움의 데이터에 대한 주요한 직렬화 방법이다. RLP는 데이터의 구조만을 인코딩하기 때문에 특정 타입의 데이터를 인코딩할 때 비용을 지불하지 않는다.  
 Positive RLP 정수는 가장 명확한 값으로 표현되어 가장 낮은 메모리 주소에(Big endian) leading zero없이 저장된다. 결과적으로 RLP 정수값에서 0은 비어있는 바이트 배열로 표현된다. 만약 비어있지 않은 deserialize된 정수가 0으로 시작된다면 유효하지 않은 것이다.
 전역 상태 데이터베이스는 빠른 탐색 및 데이터 검사를 위해 RLP로 인코딩된다. RLP 인코딩은 주소와 계정 상태 간의 매핑을 만든다. 노드 운영자의 컴퓨터에 저장되므로 네트워크 지연없이 트리를 인덱싱하고 검색 할 수 있다. RLP는 값을 바이트 배열 또는 추가 값의 시퀀스로 인코딩하며, 이후에 바이트 배열로 인코딩된다.

## The Block
 블록은 17개의 다른 요소로 만들어진다. 첫번째 15개의 요소는 블록헤더라 불리는 것이다.

### The Block Header
 Description: 트랜잭션 리스트 외에 블록에 포함된 정보는 다음과 같이 구성된다.
- Parent Hash - 부모 블록의 헤더의 Keccak-256 해시
- Ommers hash - 이 블록의 ommer 리스트 부분의 Keccak-256 해시
- Beneficiary - 모든 블록의 보상이 옮겨진 20바이트의 주소
- State Root - 블록의 트랜잭션 목록에서 각 트랜잭션으로 채워진 트리 구조의 루트 노드의 Keccak-256 해시
- Transaction Root - 블록의 트랜잭션 리스트에 있는 각 트랜잭션과 함께 살게하는 trie 구조의 루트노드의 Keccak-256 해시
- Receipts Root - 블록의 트랜잭션 목록 부분에 있는 각 트랜잭션의 수신과 함께 채워진 트리 구조의 루트 노드의 Keccak-256 해시
- Logs Bloom - 블록의 트랜잭션 목록 부분에있는 각 트랜잭션에 대한 receipt에 포함 된 인덱싱 가능한 정보 (로그 주소 및 로그 항목)로 구성된 블룸 필터
- Difficulty - 이전 블록의 난이도와 타임 스탬프에서 계산 된 블록의 난이도
- Number - 현재 블록 뒤에있는 조상블록의 개수와 동등한 양
- Gas Limit - 현재 블록당 최대 가스지출 양과 같은것
- Gas Used - 이 블록에 있는 트랜잭션들이 사용한 총 가스
- Timestamp - 블록이 처음 생성되었을때의 유닉스 시간 기록
- Extra Data - 이 블록과 관련된 추가 데이터를 포함하는 32바이트 혹은 그 이하의 바이트 배열
- Mix Hash - 이 블록이 충분한 양의 계산이 이루어졌는지 확인하는 32바이트 해시
- Nonce - 이 블록에서 충분한 양의 계산이 이루어졌는지 확인하는 8바이트 해시
- Ommer Block Headers -  위의 모든 구성 요소와 동일한 구성 요소

### Block Footer
 Transaction Series - 블록의 비 헤더 컨텐츠 (내용이 여기까지 밖에 없음)
 
### Block Number and Difficulty
 제네시스 블록의 난이도를 명심해야 한다. Homestead 난이도 매개 변수는 EIP-2에서 구현 된대로 블록 간 시간이 다양하기 때문에 블록 간 동적 항상성에 영향을 준다. Homestead  릴리스에서는 지수 난이도 기호를 사용하여 난이도를 천천히 (100,000 블록마다) 증가시켜 블록생성 시간의 차이를 늘리고 PoS로 전환하기 위한 시간적인 압박을 가한다. "난이도 폭탄"또는 "빙하기"로 알려진 이 효과는 EIP-649에서 설명되고 EIP-2에서 더 일찍 지연되고 실행되었으며, EIP-100에서 x, 조정 요인, 및 분모 9를 사용하여 삼촌 블록을 포함하는 평균 블록 시간을 목표로 한다. 마지막으로 Byzantium 릴리스에서 EIP-649를 사용하여 실제 블록 번호에서 3백만을 뺀 가짜 블록 번호를 생성하여 블록들의 시간차를 줄임으로써 빙하기를 지연시켰고 PoS를 개발하고 네트워크가 "정지"되는 것을 방지하는 데 더 많은 시간을 확보했다.

### Account Creation
 계정 생성은 컨트랙트 생성과 함께 발생하고 이것은 init과 연관되어 있다. 마지막으로 EVM 코드를 포함하는 계정이 메시지 호출을 받으면 실행되는 EVM 코드인 본문이 있다.

### Account State
 계정 상태는 몇몇 특정 전역 상태의 특정 계정에 대한 상세정보를 포함한다. 계정 상태는 4가지 변수로 구성 된다.
nonce 이 주소에서 보낸 거래들이나 계정생성은 이 주소와 관련된 계정에 의해 생성
balance 이 계정이 소유한 Wei의 양. 상태 데이터베이스에 key/value 쌍으로 저장됨
storage_root 256-비트(32 바이트) 해시의 루트 노드의 머클 패트리샤 트리는 계정의 저장 내용을 인코딩함
code_hash 이 계정의 컨트랙트에 대한 EVM 코드의 해시. 코드 해시는 상태 데이터베이스에 저장됨. 코드해시는 영구적이고 해당 주소의 계정이 메시지 콜을 받았을때 실행됨

### Bloom Filter
 Bloom Filter는 트랜잭션 목록의 각 트랜잭션 receipt로부터 각 로그 항목에 포함 된 인덱서 블 정보 (로거 주소 및 로그 항목)로 구성된다.
### Transaction Receipts
내용 
